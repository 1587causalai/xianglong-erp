{"ast":null,"code":"export default {\n  name: 'PurchaseOrderForm',\n  data() {\n    return {\n      isEditMode: false,\n      orderForm: {\n        order_no: '',\n        supplier_id: null,\n        order_date: new Date(),\n        expected_date: null,\n        order_status: 0,\n        // Draft by default\n        total_amount: 0,\n        order_remark: '',\n        items: []\n      }\n    };\n  },\n  computed: {\n    totalAmountDisplay() {\n      return this.orderForm.items.reduce((sum, item) => sum + (item.quantity * item.unit_price || 0), 0).toFixed(2);\n    }\n  },\n  created() {\n    const orderId = this.$route.params.id;\n    if (orderId && orderId !== 'new') {\n      this.isEditMode = true;\n      this.fetchOrderDetails(orderId);\n    } else {\n      this.addItem();\n    }\n  },\n  methods: {\n    fetchOrderDetails(orderId) {\n      // TODO: API call\n      console.log('Fetching purchase order:', orderId);\n      this.orderForm = {\n        purchase_order_id: orderId,\n        order_no: 'PO2023001',\n        supplier_id: '1',\n        order_date: '2023-01-05',\n        expected_date: '2023-01-20',\n        order_status: 1,\n        total_amount: 2000,\n        order_remark: '常规采购',\n        items: [{\n          order_item_id: 1,\n          component_id: '1',\n          quantity: 200,\n          unit_price: 10\n        }]\n      };\n    },\n    addItem() {\n      this.orderForm.items.push({\n        component_id: null,\n        quantity: 1,\n        unit_price: 0\n      });\n    },\n    removeItem(index) {\n      this.orderForm.items.splice(index, 1);\n    },\n    submitForm() {\n      // TODO: Validate and API call\n      this.orderForm.total_amount = parseFloat(this.totalAmountDisplay);\n      console.log('Submitting purchase order:', this.orderForm);\n      this.$message.success('采购订单保存成功!');\n      this.goBack();\n    },\n    goBack() {\n      this.$router.push({\n        name: 'PurchaseOrderList'\n      });\n    }\n  },\n  filters: {\n    toFixed(value, count) {\n      if (isNaN(parseFloat(value))) return '0.00';\n      return parseFloat(value).toFixed(count || 2);\n    }\n  }\n};","map":{"version":3,"names":["name","data","isEditMode","orderForm","order_no","supplier_id","order_date","Date","expected_date","order_status","total_amount","order_remark","items","computed","totalAmountDisplay","reduce","sum","item","quantity","unit_price","toFixed","created","orderId","$route","params","id","fetchOrderDetails","addItem","methods","console","log","purchase_order_id","order_item_id","component_id","push","removeItem","index","splice","submitForm","parseFloat","$message","success","goBack","$router","filters","value","count","isNaN"],"sources":["src/views/purchase/PurchaseOrderForm.vue"],"sourcesContent":["<template>\n  <div class=\"purchase-order-form-container\">\n    <h2>{{ isEditMode ? '编辑采购订单' : '新增采购订单' }}</h2>\n    <el-form :model=\"orderForm\" ref=\"orderFormRef\" label-width=\"100px\">\n      <el-form-item label=\"订单编号\" prop=\"order_no\">\n        <el-input v-model=\"orderForm.order_no\" :disabled=\"isEditMode\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"供应商\" prop=\"supplier_id\">\n        <!-- TODO: Searchable select for suppliers -->\n        <el-select v-model=\"orderForm.supplier_id\" placeholder=\"选择供应商\">\n          <el-option label=\"供应商A\" value=\"1\"></el-option>\n          <el-option label=\"供应商B\" value=\"2\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"订单日期\" prop=\"order_date\">\n        <el-date-picker v-model=\"orderForm.order_date\" type=\"date\" placeholder=\"选择日期\"></el-date-picker>\n      </el-form-item>\n      <el-form-item label=\"预计到货日\" prop=\"expected_date\">\n        <el-date-picker v-model=\"orderForm.expected_date\" type=\"date\" placeholder=\"选择日期\"></el-date-picker>\n      </el-form-item>\n      \n      <h3>订单明细 (配件)</h3>\n      <el-table :data=\"orderForm.items\" border style=\"margin-bottom:15px;\">\n        <el-table-column label=\"配件\">\n            <template slot-scope=\"scope\">\n                <!-- TODO: Searchable select for components -->\n                <el-select v-model=\"scope.row.component_id\" placeholder=\"选择配件\">\n                    <el-option label=\"示例配件X\" value=\"1\"></el-option>\n                    <el-option label=\"示例配件Y\" value=\"2\"></el-option>\n                </el-select>\n            </template>\n        </el-table-column>\n        <el-table-column label=\"数量\">\n            <template slot-scope=\"scope\">\n                <el-input-number v-model=\"scope.row.quantity\" :min=\"1\"></el-input-number>\n            </template>\n        </el-table-column>\n        <el-table-column label=\"单价\">\n            <template slot-scope=\"scope\">\n                <el-input-number v-model=\"scope.row.unit_price\" :min=\"0\" :precision=\"2\"></el-input-number>\n            </template>\n        </el-table-column>\n        <el-table-column label=\"金额\">\n            <template slot-scope=\"scope\">\n                {{ (scope.row.quantity * scope.row.unit_price) || 0 | toFixed(2) }}\n            </template>\n        </el-table-column>\n        <el-table-column label=\"操作\">\n            <template slot-scope=\"scope\">\n                <el-button size=\"mini\" type=\"danger\" @click=\"removeItem(scope.$index)\">移除</el-button>\n            </template>\n        </el-table-column>\n      </el-table>\n      <el-button @click=\"addItem\">添加配件</el-button>\n      \n      <el-form-item label=\"总金额\" style=\"margin-top:15px;\">\n          <el-input v-model=\"totalAmountDisplay\" readonly></el-input>\n      </el-form-item>\n\n      <el-form-item label=\"备注\" prop=\"order_remark\">\n        <el-input type=\"textarea\" v-model=\"orderForm.order_remark\"></el-input>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"submitForm\">保存</el-button>\n        <el-button @click=\"goBack\">取消</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'PurchaseOrderForm',\n  data() {\n    return {\n      isEditMode: false,\n      orderForm: {\n        order_no: '',\n        supplier_id: null,\n        order_date: new Date(),\n        expected_date: null,\n        order_status: 0, // Draft by default\n        total_amount: 0,\n        order_remark: '',\n        items: []\n      }\n    };\n  },\n  computed: {\n    totalAmountDisplay() {\n      return this.orderForm.items.reduce((sum, item) => sum + (item.quantity * item.unit_price || 0), 0).toFixed(2);\n    }\n  },\n  created() {\n    const orderId = this.$route.params.id;\n    if (orderId && orderId !== 'new') {\n      this.isEditMode = true;\n      this.fetchOrderDetails(orderId);\n    } else {\n        this.addItem(); \n    }\n  },\n  methods: {\n    fetchOrderDetails(orderId) {\n      // TODO: API call\n      console.log('Fetching purchase order:', orderId);\n      this.orderForm = {\n        purchase_order_id: orderId,\n        order_no: 'PO2023001',\n        supplier_id: '1',\n        order_date: '2023-01-05',\n        expected_date: '2023-01-20',\n        order_status: 1,\n        total_amount: 2000,\n        order_remark: '常规采购',\n        items: [\n          { order_item_id: 1, component_id: '1', quantity: 200, unit_price: 10 },\n        ]\n      };\n    },\n    addItem() {\n      this.orderForm.items.push({ component_id: null, quantity: 1, unit_price: 0 });\n    },\n    removeItem(index) {\n      this.orderForm.items.splice(index, 1);\n    },\n    submitForm() {\n      // TODO: Validate and API call\n      this.orderForm.total_amount = parseFloat(this.totalAmountDisplay);\n      console.log('Submitting purchase order:', this.orderForm);\n      this.$message.success('采购订单保存成功!');\n      this.goBack();\n    },\n    goBack() {\n      this.$router.push({ name: 'PurchaseOrderList' });\n    }\n  },\n  filters: {\n      toFixed(value, count) {\n          if (isNaN(parseFloat(value))) return '0.00';\n          return parseFloat(value).toFixed(count || 2);\n      }\n  }\n};\n</script>\n\n<style scoped>\n.purchase-order-form-container {\n  padding: 20px;\n}\n</style> "],"mappings":"AAuEA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,UAAA;MACAC,SAAA;QACAC,QAAA;QACAC,WAAA;QACAC,UAAA,MAAAC,IAAA;QACAC,aAAA;QACAC,YAAA;QAAA;QACAC,YAAA;QACAC,YAAA;QACAC,KAAA;MACA;IACA;EACA;EACAC,QAAA;IACAC,mBAAA;MACA,YAAAX,SAAA,CAAAS,KAAA,CAAAG,MAAA,EAAAC,GAAA,EAAAC,IAAA,KAAAD,GAAA,IAAAC,IAAA,CAAAC,QAAA,GAAAD,IAAA,CAAAE,UAAA,WAAAC,OAAA;IACA;EACA;EACAC,QAAA;IACA,MAAAC,OAAA,QAAAC,MAAA,CAAAC,MAAA,CAAAC,EAAA;IACA,IAAAH,OAAA,IAAAA,OAAA;MACA,KAAApB,UAAA;MACA,KAAAwB,iBAAA,CAAAJ,OAAA;IACA;MACA,KAAAK,OAAA;IACA;EACA;EACAC,OAAA;IACAF,kBAAAJ,OAAA;MACA;MACAO,OAAA,CAAAC,GAAA,6BAAAR,OAAA;MACA,KAAAnB,SAAA;QACA4B,iBAAA,EAAAT,OAAA;QACAlB,QAAA;QACAC,WAAA;QACAC,UAAA;QACAE,aAAA;QACAC,YAAA;QACAC,YAAA;QACAC,YAAA;QACAC,KAAA,GACA;UAAAoB,aAAA;UAAAC,YAAA;UAAAf,QAAA;UAAAC,UAAA;QAAA;MAEA;IACA;IACAQ,QAAA;MACA,KAAAxB,SAAA,CAAAS,KAAA,CAAAsB,IAAA;QAAAD,YAAA;QAAAf,QAAA;QAAAC,UAAA;MAAA;IACA;IACAgB,WAAAC,KAAA;MACA,KAAAjC,SAAA,CAAAS,KAAA,CAAAyB,MAAA,CAAAD,KAAA;IACA;IACAE,WAAA;MACA;MACA,KAAAnC,SAAA,CAAAO,YAAA,GAAA6B,UAAA,MAAAzB,kBAAA;MACAe,OAAA,CAAAC,GAAA,oCAAA3B,SAAA;MACA,KAAAqC,QAAA,CAAAC,OAAA;MACA,KAAAC,MAAA;IACA;IACAA,OAAA;MACA,KAAAC,OAAA,CAAAT,IAAA;QAAAlC,IAAA;MAAA;IACA;EACA;EACA4C,OAAA;IACAxB,QAAAyB,KAAA,EAAAC,KAAA;MACA,IAAAC,KAAA,CAAAR,UAAA,CAAAM,KAAA;MACA,OAAAN,UAAA,CAAAM,KAAA,EAAAzB,OAAA,CAAA0B,KAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}