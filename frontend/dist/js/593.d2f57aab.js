"use strict";(self["webpackChunkxianglong_erp_frontend"]=self["webpackChunkxianglong_erp_frontend"]||[]).push([[593],{9593:(e,r,t)=>{t.r(r),t.d(r,{default:()=>n});var o=function(){var e=this,r=e._self._c;return r("div",{staticClass:"sales-order-form-container"},[r("h2",[e._v(e._s(e.isEditMode?"编辑销售订单":"新增销售订单"))]),r("el-form",{ref:"orderFormRef",attrs:{model:e.orderForm,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"订单编号",prop:"order_no"}},[r("el-input",{attrs:{disabled:e.isEditMode},model:{value:e.orderForm.order_no,callback:function(r){e.$set(e.orderForm,"order_no",r)},expression:"orderForm.order_no"}})],1),r("el-form-item",{attrs:{label:"客户",prop:"customer_id"}},[r("el-select",{attrs:{placeholder:"选择客户"},model:{value:e.orderForm.customer_id,callback:function(r){e.$set(e.orderForm,"customer_id",r)},expression:"orderForm.customer_id"}},[r("el-option",{attrs:{label:"客户甲",value:"1"}}),r("el-option",{attrs:{label:"客户乙",value:"2"}})],1)],1),r("el-form-item",{attrs:{label:"订单日期",prop:"order_date"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.orderForm.order_date,callback:function(r){e.$set(e.orderForm,"order_date",r)},expression:"orderForm.order_date"}})],1),r("el-form-item",{attrs:{label:"交付日期",prop:"delivery_date"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.orderForm.delivery_date,callback:function(r){e.$set(e.orderForm,"delivery_date",r)},expression:"orderForm.delivery_date"}})],1),r("h3",[e._v("订单明细")]),r("el-table",{staticStyle:{"margin-bottom":"15px"},attrs:{data:e.orderForm.items,border:""}},[r("el-table-column",{attrs:{label:"产品"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-select",{attrs:{placeholder:"选择产品"},model:{value:t.row.product_id,callback:function(r){e.$set(t.row,"product_id",r)},expression:"scope.row.product_id"}},[r("el-option",{attrs:{label:"示例产品A",value:"1"}}),r("el-option",{attrs:{label:"示例产品B",value:"2"}})],1)]}}])}),r("el-table-column",{attrs:{label:"数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input-number",{attrs:{min:1},model:{value:t.row.quantity,callback:function(r){e.$set(t.row,"quantity",r)},expression:"scope.row.quantity"}})]}}])}),r("el-table-column",{attrs:{label:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input-number",{attrs:{min:0,precision:2},model:{value:t.row.unit_price,callback:function(r){e.$set(t.row,"unit_price",r)},expression:"scope.row.unit_price"}})]}}])}),r("el-table-column",{attrs:{label:"金额"},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v(" "+e._s(e._f("toFixed")(r.row.quantity*r.row.unit_price||0,2))+" ")]}}])}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return e.removeItem(t.$index)}}},[e._v("移除")])]}}])})],1),r("el-button",{on:{click:e.addItem}},[e._v("添加产品")]),r("el-form-item",{staticStyle:{"margin-top":"15px"},attrs:{label:"总金额"}},[r("el-input",{attrs:{readonly:""},model:{value:e.totalAmountDisplay,callback:function(r){e.totalAmountDisplay=r},expression:"totalAmountDisplay"}})],1),r("el-form-item",{attrs:{label:"备注",prop:"order_remark"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.orderForm.order_remark,callback:function(r){e.$set(e.orderForm,"order_remark",r)},expression:"orderForm.order_remark"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保存")]),r("el-button",{on:{click:e.goBack}},[e._v("取消")])],1)],1)],1)},l=[];const a={name:"SalesOrderForm",data(){return{isEditMode:!1,orderForm:{order_no:"",customer_id:null,order_date:new Date,delivery_date:null,order_status:0,total_amount:0,order_remark:"",items:[]}}},computed:{totalAmountDisplay(){return this.orderForm.items.reduce(((e,r)=>e+(r.quantity*r.unit_price||0)),0).toFixed(2)}},created(){const e=this.$route.params.id;e&&"new"!==e?(this.isEditMode=!0,this.fetchOrderDetails(e)):this.addItem()},methods:{fetchOrderDetails(e){console.log("Fetching sales order:",e),this.orderForm={sales_order_id:e,order_no:"SO2023001",customer_id:"1",order_date:"2023-01-10",delivery_date:"2023-02-01",order_status:1,total_amount:5e3,order_remark:"加急订单",items:[{order_item_id:1,product_id:"1",quantity:50,unit_price:100}]}},addItem(){this.orderForm.items.push({product_id:null,quantity:1,unit_price:0})},removeItem(e){this.orderForm.items.splice(e,1)},submitForm(){this.orderForm.total_amount=parseFloat(this.totalAmountDisplay),console.log("Submitting sales order:",this.orderForm),this.$message.success("订单保存成功!"),this.goBack()},goBack(){this.$router.push({name:"SalesOrderList"})}},filters:{toFixed(e,r){return isNaN(parseFloat(e))?"0.00":parseFloat(e).toFixed(r||2)}}},s=a;var i=t(1656),d=(0,i.A)(s,o,l,!1,null,"f8ddc940",null);const n=d.exports}}]);
//# sourceMappingURL=593.d2f57aab.js.map