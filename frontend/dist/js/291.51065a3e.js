"use strict";(self["webpackChunkxianglong_erp_frontend"]=self["webpackChunkxianglong_erp_frontend"]||[]).push([[291],{5291:(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"purchase-order-form-container"},[t("h2",[e._v(e._s(e.isEditMode?"编辑采购订单":"新增采购订单"))]),t("el-form",{ref:"orderFormRef",attrs:{model:e.orderForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"订单编号",prop:"order_no"}},[t("el-input",{attrs:{disabled:e.isEditMode},model:{value:e.orderForm.order_no,callback:function(t){e.$set(e.orderForm,"order_no",t)},expression:"orderForm.order_no"}})],1),t("el-form-item",{attrs:{label:"供应商",prop:"supplier_id"}},[t("el-select",{attrs:{placeholder:"选择供应商"},model:{value:e.orderForm.supplier_id,callback:function(t){e.$set(e.orderForm,"supplier_id",t)},expression:"orderForm.supplier_id"}},[t("el-option",{attrs:{label:"供应商A",value:"1"}}),t("el-option",{attrs:{label:"供应商B",value:"2"}})],1)],1),t("el-form-item",{attrs:{label:"订单日期",prop:"order_date"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.orderForm.order_date,callback:function(t){e.$set(e.orderForm,"order_date",t)},expression:"orderForm.order_date"}})],1),t("el-form-item",{attrs:{label:"预计到货日",prop:"expected_date"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.orderForm.expected_date,callback:function(t){e.$set(e.orderForm,"expected_date",t)},expression:"orderForm.expected_date"}})],1),t("h3",[e._v("订单明细 (配件)")]),t("el-table",{staticStyle:{"margin-bottom":"15px"},attrs:{data:e.orderForm.items,border:""}},[t("el-table-column",{attrs:{label:"配件"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-select",{attrs:{placeholder:"选择配件"},model:{value:r.row.component_id,callback:function(t){e.$set(r.row,"component_id",t)},expression:"scope.row.component_id"}},[t("el-option",{attrs:{label:"示例配件X",value:"1"}}),t("el-option",{attrs:{label:"示例配件Y",value:"2"}})],1)]}}])}),t("el-table-column",{attrs:{label:"数量"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-input-number",{attrs:{min:1},model:{value:r.row.quantity,callback:function(t){e.$set(r.row,"quantity",t)},expression:"scope.row.quantity"}})]}}])}),t("el-table-column",{attrs:{label:"单价"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-input-number",{attrs:{min:0,precision:2},model:{value:r.row.unit_price,callback:function(t){e.$set(r.row,"unit_price",t)},expression:"scope.row.unit_price"}})]}}])}),t("el-table-column",{attrs:{label:"金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("toFixed")(t.row.quantity*t.row.unit_price||0,2))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.removeItem(r.$index)}}},[e._v("移除")])]}}])})],1),t("el-button",{on:{click:e.addItem}},[e._v("添加配件")]),t("el-form-item",{staticStyle:{"margin-top":"15px"},attrs:{label:"总金额"}},[t("el-input",{attrs:{readonly:""},model:{value:e.totalAmountDisplay,callback:function(t){e.totalAmountDisplay=t},expression:"totalAmountDisplay"}})],1),t("el-form-item",{attrs:{label:"备注",prop:"order_remark"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.orderForm.order_remark,callback:function(t){e.$set(e.orderForm,"order_remark",t)},expression:"orderForm.order_remark"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保存")]),t("el-button",{on:{click:e.goBack}},[e._v("取消")])],1)],1)],1)},a=[];const l={name:"PurchaseOrderForm",data(){return{isEditMode:!1,orderForm:{order_no:"",supplier_id:null,order_date:new Date,expected_date:null,order_status:0,total_amount:0,order_remark:"",items:[]}}},computed:{totalAmountDisplay(){return this.orderForm.items.reduce(((e,t)=>e+(t.quantity*t.unit_price||0)),0).toFixed(2)}},created(){const e=this.$route.params.id;e&&"new"!==e?(this.isEditMode=!0,this.fetchOrderDetails(e)):this.addItem()},methods:{fetchOrderDetails(e){console.log("Fetching purchase order:",e),this.orderForm={purchase_order_id:e,order_no:"PO2023001",supplier_id:"1",order_date:"2023-01-05",expected_date:"2023-01-20",order_status:1,total_amount:2e3,order_remark:"常规采购",items:[{order_item_id:1,component_id:"1",quantity:200,unit_price:10}]}},addItem(){this.orderForm.items.push({component_id:null,quantity:1,unit_price:0})},removeItem(e){this.orderForm.items.splice(e,1)},submitForm(){this.orderForm.total_amount=parseFloat(this.totalAmountDisplay),console.log("Submitting purchase order:",this.orderForm),this.$message.success("采购订单保存成功!"),this.goBack()},goBack(){this.$router.push({name:"PurchaseOrderList"})}},filters:{toFixed(e,t){return isNaN(parseFloat(e))?"0.00":parseFloat(e).toFixed(t||2)}}},i=l;var s=r(1656),n=(0,s.A)(i,o,a,!1,null,"e3af41ca",null);const d=n.exports}}]);
//# sourceMappingURL=291.51065a3e.js.map